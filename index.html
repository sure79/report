<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>운세 분석 센터 - 해운번호 그래프 & 사주번호 다각형</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700;900&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        /* 행운 분석 추가 스타일 */
        .fortune-analysis-section {
            margin-top: 40px;
            display: none;
        }
        
        .fortune-card {
            background: white;
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.08);
            border: 1px solid rgba(0, 0, 0, 0.03);
            position: relative;
            overflow: hidden;
        }
        
        .fortune-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #FF6B9D, #48CFCB, #FE5757);
        }
        
        .fortune-card-title {
            font-size: 24px;
            font-weight: 700;
            color: #333;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .fortune-card-title::before {
            content: '';
            width: 6px;
            height: 25px;
            background: linear-gradient(135deg, #FF6B9D, #48CFCB);
            border-radius: 3px;
        }
        
        .fortune-lucky-numbers {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .fortune-number-item {
            background: linear-gradient(135deg, #FF6B9D, #48CFCB);
            color: white;
            padding: 12px 20px;
            border-radius: 25px;
            font-size: 18px;
            font-weight: 600;
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.2);
            transition: all 0.3s;
        }
        
        .fortune-number-item:hover {
            transform: scale(1.1) rotate(3deg);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
        }
        
        .fortune-color-section {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .fortune-color-item {
            padding: 20px;
            border-radius: 15px;
            font-weight: 600;
            font-size: 16px;
            color: white;
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.2);
            transition: all 0.3s;
            text-align: center;
        }
        
        .fortune-color-item:hover {
            transform: translateY(-5px) scale(1.05);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
        }
        
        .fortune-chosung-section {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-bottom: 30px;
            padding: 20px;
            background: linear-gradient(135deg, #f0f9ff, #f5f5ff);
            border-radius: 15px;
            border: 2px solid rgba(72, 207, 203, 0.2);
        }
        
        .fortune-chosung-item {
            background: linear-gradient(135deg, #48CFCB, #26A69A);
            color: white;
            padding: 10px 20px;
            border-radius: 20px;
            font-size: 18px;
            font-weight: 600;
            box-shadow: 0 4px 12px rgba(72, 207, 203, 0.4);
            transition: all 0.3s;
        }
        
        .fortune-chosung-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 18px rgba(72, 207, 203, 0.5);
        }
        
        .fortune-chosung-label {
            font-size: 16px;
            color: #334155;
            margin-bottom: 15px;
            font-weight: 600;
        }
        
        .fortune-region-container {
            margin-top: 20px;
        }
        
        .fortune-region-category {
            margin-bottom: 25px;
            padding: 20px;
            background: linear-gradient(135deg, #fafbfc, #ffffff);
            border-radius: 15px;
            border: 1px solid rgba(0, 0, 0, 0.05);
        }
        
        .fortune-region-category-title {
            font-size: 18px;
            font-weight: 600;
            color: #333;
            margin-bottom: 12px;
            padding-left: 12px;
            border-left: 3px solid #48CFCB;
        }
        
        .fortune-region-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 10px;
        }
        
        .fortune-region-item {
            background: linear-gradient(135deg, #ffffff, #f8faff);
            padding: 10px 15px;
            border-radius: 12px;
            border: 2px solid transparent;
            transition: all 0.3s;
            text-align: center;
            font-weight: 500;
            font-size: 13px;
            cursor: pointer;
        }
        
        .fortune-region-item:hover {
            border-color: #48CFCB;
            background: linear-gradient(135deg, #e6fffa, #f0fdfa);
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(72, 207, 203, 0.25);
        }
        
        .fortune-special-region {
            background: linear-gradient(135deg, #fff4e6, #fffbf0);
            border-color: #fbbf24;
        }
        
        .fortune-special-region:hover {
            border-color: #f59e0b;
            background: linear-gradient(135deg, #fef3c7, #fffbeb);
            box-shadow: 0 6px 15px rgba(251, 191, 36, 0.3);
        }
        
        .fortune-warning-text {
            background: linear-gradient(135deg, #fff8e1, #fff3cd);
            color: #7c5e10;
            padding: 15px;
            border-radius: 12px;
            margin-top: 20px;
            font-size: 14px;
            border: 1px solid #ffd960;
            box-shadow: 0 3px 8px rgba(255, 217, 96, 0.2);
        }
        
        .fortune-description-text {
            color: #64748b;
            margin: 15px 0;
            font-size: 14px;
            line-height: 1.6;
        }
        
        /* 생활별 추천시기 스타일 */
        .life-recommendations-content {
            display: grid;
            gap: 30px;
            margin-top: 30px;
        }
        
        .life-category {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.08);
            border: 1px solid rgba(0, 0, 0, 0.05);
            position: relative;
            overflow: hidden;
        }
        
        .life-category::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 5px;
            background: linear-gradient(90deg, #FF6B9D, #48CFCB, #FE5757);
        }
        
        .life-category-title {
            font-size: 24px;
            font-weight: 700;
            color: #333;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .life-category-title::before {
            content: '';
            width: 6px;
            height: 30px;
            background: linear-gradient(135deg, #FF6B9D, #48CFCB);
            border-radius: 3px;
        }
        
        .timing-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .timing-item {
            background: linear-gradient(135deg, #f8faff, #ffffff);
            border-radius: 15px;
            padding: 20px;
            border: 2px solid transparent;
            transition: all 0.3s ease;
            position: relative;
        }
        
        .timing-item.excellent {
            border-color: #10b981;
            background: linear-gradient(135deg, #ecfdf5, #f0fdf4);
        }
        
        .timing-item.good {
            border-color: #3b82f6;
            background: linear-gradient(135deg, #eff6ff, #f0f9ff);
        }
        
        .timing-item.caution {
            border-color: #f59e0b;
            background: linear-gradient(135deg, #fffbeb, #fefce8);
        }
        
        .timing-item.avoid {
            border-color: #ef4444;
            background: linear-gradient(135deg, #fef2f2, #fef7f7);
        }
        
        .timing-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }
        
        .timing-badge {
            display: inline-block;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            margin-bottom: 10px;
        }
        
        .timing-badge.excellent {
            background: #10b981;
            color: white;
        }
        
        .timing-badge.good {
            background: #3b82f6;
            color: white;
        }
        
        .timing-badge.caution {
            background: #f59e0b;
            color: white;
        }
        
        .timing-badge.avoid {
            background: #ef4444;
            color: white;
        }
        
        .timing-year {
            font-size: 18px;
            font-weight: 700;
            color: #333;
            margin-bottom: 8px;
        }
        
        .timing-score {
            font-size: 14px;
            color: #666;
            margin-bottom: 12px;
        }
        
        .timing-reason {
            font-size: 14px;
            color: #555;
            line-height: 1.5;
        }
        
        .timing-summary {
            background: linear-gradient(135deg, #f0f9ff, #e0f2fe);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            border: 2px solid rgba(59, 130, 246, 0.2);
        }
        
        .timing-summary h4 {
            color: #1e40af;
            margin-bottom: 10px;
            font-size: 18px;
        }
        
        .timing-summary p {
            color: #334155;
            line-height: 1.6;
            margin: 0;
        }
        
        body {
            font-family: 'Noto Sans KR', 'Malgun Gothic', sans-serif;
            background: #ffffff !important;
            min-height: 100vh;
            padding: 20px;
            position: relative;
            overflow-x: hidden;
        }


        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: #ffffff !important;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 
                0 10px 30px rgba(0, 0, 0, 0.1),
                0 4px 8px rgba(0, 0, 0, 0.05);
            border: 1px solid #e9ecef;
            position: relative;
        }

        .container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.8), transparent);
        }
        
        .header {
            background: #ffffff !important;
            color: #333333 !important;
            padding: 40px 30px;
            text-align: center;
            position: relative;
            border-bottom: 2px solid #f0f0f0;
        }
        
        .header h1 {
            font-size: 2.8em;
            margin-bottom: 15px;
            font-weight: 900;
            letter-spacing: -1px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .header p {
            font-size: 1.2em;
            opacity: 0.95;
            font-weight: 400;
        }

        /* 탭 네비게이션 */
        .tab-navigation {
            display: flex;
            justify-content: center;
            gap: 0;
            margin-top: 30px;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
            background: #f8f9fa;
        }

        .tab-button {
            padding: 15px 35px;
            background: #f8f9fa;
            color: #666666;
            border: 2px solid #e9ecef;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s ease;
            position: relative;
            flex: 1;
            max-width: 200px;
        }

        .tab-button.active {
            background: #667eea;
            color: white;
            border-color: #667eea;
            box-shadow: 0 2px 8px rgba(102, 126, 234, 0.3);
        }

        .tab-button:hover:not(.active) {
            background: #e9ecef;
            color: #333333;
            border-color: #dee2e6;
        }
        
        .input-section {
            padding: 30px;
            background: #ffffff;
            border-bottom: 2px solid #f0f0f0;
        }
        
        .input-form {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            flex-wrap: wrap;
        }
        
        .input-group {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .input-group label {
            font-weight: bold;
            margin-bottom: 8px;
            color: #333;
        }
        
        .haeun-input {
            padding: 12px 20px;
            border: 2px solid #ddd;
            border-radius: 10px;
            font-size: 18px;
            text-align: center;
            width: 120px;
            transition: all 0.3s ease;
        }
        
        .haeun-input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 10px rgba(102, 126, 234, 0.2);
        }
        
        .generate-btn {
            padding: 15px 30px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 25px;
        }
        
        .generate-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
        }
        
        .result-section {
            padding: 30px;
            display: none;
        }
        
        .summary-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .summary-card {
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            color: white;
            font-weight: bold;
        }
        
        .card-best {
            background: linear-gradient(135deg, #f093fb, #f5576c);
        }
        
        .card-avg {
            background: linear-gradient(135deg, #4ecdc4, #44a08d);
        }
        
        .card-caution {
            background: linear-gradient(135deg, #ff6b6b, #ee5a52);
        }
        
        .chart-container {
            position: relative;
            height: 500px;
            margin-bottom: 30px;
            background: white;
            border-radius: 15px;
            padding: 20px;
        }
        
        .details-section {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 20px;
            margin-top: 20px;
            border: 1px solid #e9ecef;
        }
        
        .year-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        /* 해운 풀이 스타일 */
        .copy-section {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
            border: 1px solid #e9ecef;
        }
        
        .copy-btn {
            background: linear-gradient(135deg, #28a745, #20c997);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-right: 15px;
        }
        
        .copy-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(40, 167, 69, 0.3);
        }
        
        .copy-status {
            color: #28a745;
            font-weight: 600;
            background: rgba(40, 167, 69, 0.1);
            padding: 8px 16px;
            border-radius: 20px;
            border: 1px solid #28a745;
        }
        
        .haeun-text-content {
            background: #ffffff;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            padding: 30px;
            font-family: 'Noto Sans KR', sans-serif;
            line-height: 1.6;
            color: #333;
            max-height: 600px;
            overflow-y: auto;
        }
        
        .document-title {
            text-align: center;
            margin-bottom: 40px;
            padding-bottom: 20px;
            border-bottom: 3px solid #667eea;
        }
        
        .document-title h3 {
            color: #333;
            font-size: 28px;
            margin-bottom: 10px;
        }
        
        .document-subtitle {
            color: #666;
            font-size: 14px;
        }
        
        .year-fortune-section {
            margin-bottom: 40px;
        }
        
        .year-header {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 15px 20px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        
        .year-header h4 {
            margin: 0 0 8px 0;
            font-size: 20px;
        }
        
        .year-summary {
            font-size: 14px;
            opacity: 0.9;
        }
        
        .haeun-details {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 20px;
        }
        
        .haeun-block {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            border-left: 4px solid #667eea;
        }
        
        .haeun-block h5 {
            color: #333;
            margin: 0 0 10px 0;
            font-size: 16px;
        }
        
        .haeun-meaning {
            color: #666;
            font-size: 14px;
            margin-bottom: 15px;
            font-style: italic;
        }
        
        .general-info, .fortune-detail, .advice-detail {
            margin-bottom: 15px;
            padding: 10px 0;
        }
        
        .general-info strong, .fortune-detail strong, .advice-detail strong {
            color: #333;
            display: block;
            margin-bottom: 5px;
        }
        
        .fortune-detail em {
            color: #666;
            font-size: 13px;
        }
        
        .no-detail {
            color: #999;
            font-style: italic;
            padding: 10px;
            text-align: center;
        }
        
        .year-divider {
            text-align: center;
            color: #ccc;
            margin: 30px 0;
            font-family: monospace;
        }
        
        @media (max-width: 768px) {
            .haeun-details {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            
            .haeun-text-content {
                padding: 20px;
            }
            
            .document-title h3 {
                font-size: 24px;
            }
        }
        .haeun-detail-section {
            background: white !important;
            border: 1px solid #e1e5e9 !important;
            border-radius: 12px;
            padding: 25px;
            margin-top: 30px;
        }

        .haeun-detail-content {
            display: grid;
            gap: 25px;
        }

        .haeun-overview {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 12px;
            text-align: center;
        }

        .haeun-overview h4 {
            margin: 0 0 10px 0;
            font-size: 1.3em;
            font-weight: 600;
        }

        .haeun-overview .meaning {
            font-size: 1.1em;
            margin-bottom: 15px;
            opacity: 0.95;
        }

        .haeun-overview .general {
            font-size: 1em;
            line-height: 1.6;
            opacity: 0.9;
        }

        .fortune-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
        }

        .fortune-card {
            background: white !important;
            border: 1px solid #e1e5e9 !important;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .fortune-card h5 {
            margin: 0 0 15px 0;
            font-size: 1.1em;
            font-weight: 600;
            color: #333;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .fortune-card .content {
            color: #555;
            line-height: 1.6;
            margin-bottom: 15px;
        }

        .fortune-card .example {
            background: #f8f9fa !important;
            border-left: 4px solid #007bff;
            padding: 12px 15px;
            margin: 15px 0;
            font-style: italic;
            color: #666;
            border-radius: 0 8px 8px 0;
        }

        .fortune-card .warning {
            background: #fff3cd !important;
            border-left: 4px solid #ffc107;
            padding: 12px 15px;
            margin: 15px 0;
            color: #856404;
            border-radius: 0 8px 8px 0;
        }

        .advice-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 20px;
        }

        .advice-card {
            background: white !important;
            border: 1px solid #e1e5e9 !important;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .advice-card h5 {
            margin: 0 0 15px 0;
            font-size: 1.1em;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .todo-card h5 {
            color: #28a745;
        }

        .caution-card h5 {
            color: #dc3545;
        }

        .advice-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .advice-list li {
            padding: 10px 0;
            border-bottom: 1px solid #f1f3f4;
            line-height: 1.5;
            color: #555;
        }

        .advice-list li:last-child {
            border-bottom: none;
        }

        .advice-list li:before {
            content: "✓ ";
            color: #28a745;
            font-weight: bold;
            margin-right: 8px;
        }

        .caution-card .advice-list li:before {
            content: "⚠ ";
            color: #dc3545;
        }
        
        .year-card {
            background: white;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            border: 2px solid #f0f0f0;
            transition: all 0.3s ease;
        }
        
        .year-card:hover {
            border-color: #667eea;
            transform: translateY(-2px);
            box-shadow: 0 8px 16px rgba(0,0,0,0.1);
        }
        
        .year-card.peak {
            border-color: #ffd700;
            background: linear-gradient(135deg, #fff9c4, #ffeaa7);
        }
        
        .year-card.reset {
            border-color: #74b9ff;
            background: linear-gradient(135deg, #e3f2fd, #bbdefb);
        }
        
        .score-high { color: #4caf50; font-weight: bold; }
        .score-medium { color: #ff9800; font-weight: bold; }
        .score-low { color: #f44336; font-weight: bold; }
        
        .example-section {
            padding: 20px;
            background: #fff;
            margin-top: 20px;
            border-radius: 10px;
        }
        
        .example-btn {
            background: #e3f2fd;
            border: 1px solid #2196f3;
            color: #1976d2;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
            transition: all 0.3s ease;
        }
        
        .example-btn:hover {
            background: #2196f3;
            color: white;
        }

        .error-message {
            color: #f44336;
            background: #ffebee;
            padding: 10px;
            border-radius: 5px;
            margin-top: 10px;
            display: none;
        }

        /* 탭 컨텐츠 */
        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* 사주번호 분석 스타일 */
        .saju-container {
            padding: 50px;
            text-align: center;
        }

        .saju-title {
            font-size: 2.5em;
            color: #1a1a2e;
            margin-bottom: 40px;
            font-weight: 900;
            letter-spacing: -1px;
            background: linear-gradient(135deg, #FF6B9D 0%, #48CFCB 50%, #FE5757 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .saju-input-container {
            display: flex;
            gap: 25px;
            margin-bottom: 50px;
            flex-wrap: wrap;
            justify-content: center;
            align-items: center;
        }

        .saju-input-group {
            display: flex;
            align-items: center;
            gap: 15px;
            background: linear-gradient(135deg, #f8faff, #ffffff);
            padding: 20px 30px;
            border-radius: 25px;
            border: 1px solid rgba(0, 0, 0, 0.05);
            box-shadow: 
                0 10px 25px rgba(0, 0, 0, 0.05),
                inset 0 1px 2px rgba(255, 255, 255, 0.9);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .saju-input-group:hover {
            transform: translateY(-5px);
            box-shadow: 
                0 20px 40px rgba(0, 0, 0, 0.12),
                0 0 0 1px rgba(72, 207, 203, 0.3);
        }

        .saju-input {
            padding: 18px 20px;
            border: 2px solid #e8ecf5;
            background: #ffffff;
            border-radius: 18px;
            font-size: 24px;
            width: 85px;
            text-align: center;
            color: #1a1a2e;
            font-weight: 700;
            transition: all 0.3s;
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.04);
            -webkit-appearance: none;
            -moz-appearance: textfield;
            appearance: none;
        }

        .saju-input::-webkit-outer-spin-button,
        .saju-input::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }

        .saju-input:focus {
            outline: none;
            border-color: #48CFCB;
            background: #f0ffff;
            box-shadow: 
                0 0 0 4px rgba(72, 207, 203, 0.2),
                inset 0 2px 4px rgba(0, 0, 0, 0.02);
            transform: scale(1.05);
        }

        .saju-button {
            padding: 20px 50px;
            background: linear-gradient(135deg, #FF6B9D, #FE5757);
            color: white;
            border: none;
            border-radius: 25px;
            font-size: 18px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 
                0 10px 30px rgba(255, 107, 157, 0.4),
                inset 0 1px 2px rgba(255, 255, 255, 0.3);
            letter-spacing: 0.5px;
            position: relative;
            overflow: hidden;
        }

        .saju-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
            transition: left 0.6s;
        }

        .saju-button:hover {
            transform: translateY(-3px);
            box-shadow: 
                0 15px 40px rgba(255, 107, 157, 0.5),
                inset 0 1px 2px rgba(255, 255, 255, 0.4);
            background: linear-gradient(135deg, #FF7FA7, #FE6868);
        }

        .saju-button:hover::before {
            left: 100%;
        }

        .saju-chart-container {
            position: relative;
            width: 100%;
            height: 500px;
            margin: 50px 0;
            display: flex;
            justify-content: center;
            align-items: center;
            background: linear-gradient(135deg, #f8fafff0, #ffffff);
            border-radius: 30px;
            box-shadow: 
                inset 0 4px 12px rgba(0, 0, 0, 0.05),
                0 2px 8px rgba(0, 0, 0, 0.03);
            border: 1px solid rgba(0, 0, 0, 0.03);
            overflow: hidden;
        }

        .saju-chart-container::before {
            content: '';
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            background: linear-gradient(135deg, #FF6B9D, #48CFCB, #FE5757);
            border-radius: 30px;
            opacity: 0.1;
            z-index: -1;
        }

        .saju-result-text {
            text-align: center;
            margin-top: 40px;
            font-size: 36px;
            color: #1a1a2e;
            font-weight: 900;
            letter-spacing: -1px;
        }

        .saju-result-text span {
            background: linear-gradient(135deg, #FF6B9D, #48CFCB);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-size: 48px;
        }

        .saju-stats-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
            gap: 20px;
            margin-top: 40px;
        }

        .saju-stat-item {
            background: linear-gradient(135deg, #ffffff, #f8faff);
            border: 1px solid rgba(0, 0, 0, 0.04);
            border-radius: 20px;
            padding: 25px;
            text-align: center;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .saju-stat-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, #FF6B9D, #48CFCB);
            transform: scaleX(0);
            transition: transform 0.4s;
        }

        .saju-stat-item:hover {
            transform: translateY(-5px);
            box-shadow: 
                0 15px 35px rgba(0, 0, 0, 0.1),
                0 5px 15px rgba(0, 0, 0, 0.08);
            border-color: rgba(72, 207, 203, 0.3);
        }

        .saju-stat-item:hover::before {
            transform: scaleX(1);
        }

        .saju-stat-label {
            font-size: 14px;
            color: #64748b;
            margin-bottom: 10px;
            font-weight: 500;
            letter-spacing: 0.5px;
        }

        .saju-stat-value {
            font-size: 32px;
            font-weight: 900;
            background: linear-gradient(135deg, #FF6B9D, #48CFCB);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .slash {
            font-size: 28px;
            color: #cbd5e0;
            margin: 0 8px;
            font-weight: 300;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🔮 운세 분석 센터</h1>
            <p>해운번호 10년 그래프와 사주번호 다각형 분석을 한번에!</p>
            <div class="tab-navigation">
                <button class="tab-button active" onclick="showTab('haeun')">해운번호 그래프</button>
                <button class="tab-button" onclick="showTab('saju')">사주번호 다각형</button>
            </div>
        </div>
        
        <!-- 해운번호 탭 -->
        <div id="haeun-tab" class="tab-content active">
            <div class="input-section">
                <div class="input-form">
                    <div class="input-group">
                        <label for="haeun1">첫 번째 해운번호</label>
                        <input type="text" id="haeun1" class="haeun-input" placeholder="예: 9/16" maxlength="5">
                    </div>
                    
                    <div style="font-size: 24px; color: #667eea; font-weight: bold;">+</div>
                    
                    <div class="input-group">
                        <label for="haeun2">두 번째 해운번호</label>
                        <input type="text" id="haeun2" class="haeun-input" placeholder="예: 5/11" maxlength="5">
                    </div>
                    
                    <button class="generate-btn" onclick="generateGraph()">
                        📊 그래프 생성하기
                    </button>
                </div>
                
                <div class="error-message" id="errorMessage"></div>
                
                <div class="example-section">
                    <h4>📋 예시 해운번호 (클릭하면 자동 입력)</h4>
                    <button class="example-btn" onclick="setExample('9/16', '5/11')">9/16 + 5/11</button>
                    <button class="example-btn" onclick="setExample('7/13', '3/8')">7/13 + 3/8</button>
                    <button class="example-btn" onclick="setExample('1/7', '6/12')">1/7 + 6/12</button>
                    <button class="example-btn" onclick="setExample('4/10', '8/14')">4/10 + 8/14</button>
                    <button class="example-btn" onclick="setExample('2/9', '0/6')">2/9 + 0/6</button>
                </div>
            </div>
            
            <div class="result-section" id="resultSection">
                <div class="summary-cards">
                    <div class="summary-card card-best">
                        <h3>🌟 최고 운세</h3>
                        <div id="bestYear"></div>
                    </div>
                    <div class="summary-card card-avg">
                        <h3>📈 평균 점수</h3>
                        <div id="avgScore"></div>
                    </div>
                    <div class="summary-card card-caution">
                        <h3>⚠️ 주의 시기</h3>
                        <div id="cautionYear"></div>
                    </div>
                </div>
                
                <div class="chart-container">
                    <canvas id="haeunChart"></canvas>
                </div>
                
                <div class="details-section">
                    <h3>📅 연도별 상세 분석</h3>
                    <div id="yearDetails" class="year-grid"></div>
                </div>

                <!-- 해운 풀이 섹션 -->
                <div class="haeun-detail-section" id="haeunDetailSection" style="display: none;">
                    <h3>🔮 해운번호 상세 풀이</h3>
                    <div id="haeunDetailContent" class="haeun-detail-content"></div>
                </div>
            </div>
        </div>

        <!-- 사주번호 탭 -->
        <div id="saju-tab" class="tab-content">
            <div class="saju-container">
                <h2 class="saju-title">사주번호 다각형 분석</h2>
                <div class="saju-input-container">
                    <div class="saju-input-group">
                        <input type="text" id="num1" class="saju-input" placeholder="20" value="20">
                        <span class="slash">,</span>
                        <input type="text" id="num2" class="saju-input" placeholder="4" value="4">
                    </div>
                    <span class="slash">/</span>
                    <div class="saju-input-group">
                        <input type="text" id="num3" class="saju-input" placeholder="8" value="8">
                        <span class="slash">,</span>
                        <input type="text" id="num4" class="saju-input" placeholder="10" value="10">
                    </div>
                    <button class="saju-button" onclick="generateSajuChart()">분석하기</button>
                </div>
                <div class="saju-chart-container">
                    <canvas id="radarChart" width="500" height="500"></canvas>
                </div>
                <div class="saju-result-text" id="resultText"></div>
                <div class="saju-stats-container" id="statsContainer"></div>
                
                <!-- 행운 분석 섹션 추가 -->
                <div class="fortune-analysis-section" id="fortuneAnalysisSection">
                    <div class="copy-section">
                        <button class="copy-btn" onclick="copySajuFortuneText()">📋 행운 분석 텍스트 복사</button>
                        <div class="copy-status" id="sajuFortuneCopyStatus" style="display: none;">복사 완료! ✅</div>
                    </div>
                    <div class="fortune-card">
                        <h3 class="fortune-card-title">🎰 행운의 숫자</h3>
                        <div class="fortune-lucky-numbers" id="fortuneLuckyNumbers"></div>
                        <p class="fortune-description-text" id="fortuneNumberDescription"></p>
                    </div>

                    <div class="fortune-card">
                        <h3 class="fortune-card-title">🎨 행운의 색상</h3>
                        <div class="fortune-color-section" id="fortuneColorSection"></div>
                        <p class="fortune-description-text" id="fortuneColorDescription"></p>
                    </div>

                    <div class="fortune-card">
                        <h3 class="fortune-card-title">📍 추천 지역</h3>
                        <div class="fortune-chosung-label">당신의 사주번호와 조화를 이루는 초성:</div>
                        <div class="fortune-chosung-section" id="fortuneChosungSection"></div>
                        <p class="fortune-description-text" id="fortuneRegionDescription"></p>
                        <div class="fortune-region-container" id="fortuneRegionContainer"></div>
                        <div class="fortune-warning-text">
                            💡 지역 추천은 사주번호의 기운과 지역명의 초성이 조화를 이루는 곳들입니다.<br>
                            특별히 "물"과 관련된 지역(강, 해, 호수 등)과 "중앙" 지역은 특별한 기운을 가지고 있습니다.
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- 생활별 추천시기 섹션 -->
        <div class="haeun-section" id="lifeRecommendationSection" style="display: none;">
            <div class="section-header">
                <h3 class="section-title">📅 생활별 추천시기 가이드</h3>
                <p class="section-description">10년간 해운 흐름을 바탕으로 한 최적의 시기 분석</p>
            </div>
            <div class="copy-section">
                <button class="copy-btn" onclick="copyLifeRecommendationText()">📋 생활별 추천시기 텍스트 복사</button>
                <div class="copy-status" id="lifeCopyStatus" style="display: none;">복사 완료! ✅</div>
            </div>
            <div class="life-recommendations-content" id="lifeRecommendationsContent"></div>
        </div>
    </div>

    <!-- 해운 데이터 파일 -->
    <script src="haeun-data.js"></script>
    
    <script>

        let currentChart = null;

        // 해운번호 유효성 검사
        function validateHaeun(haeun) {
            const pattern = /^\d{1,2}\/\d{1,2}$/;
            if (!pattern.test(haeun)) return false;
            
            const [num, den] = haeun.split('/').map(Number);
            return num >= 0 && num <= 9 && den >= 5 && den <= 17;
        }

        // 예시 설정
        function setExample(haeun1, haeun2) {
            document.getElementById('haeun1').value = haeun1;
            document.getElementById('haeun2').value = haeun2;
        }

        // 에러 메시지 표시
        function showError(message) {
            const errorDiv = document.getElementById('errorMessage');
            errorDiv.textContent = message;
            errorDiv.style.display = 'block';
            setTimeout(() => {
                errorDiv.style.display = 'none';
            }, 3000);
        }

        // 생활별 추천시기 텍스트 복사 함수
        function copyLifeRecommendationText() {
            const content = document.getElementById('lifeRecommendationsContent');
            if (!content || content.innerHTML === '') {
                alert('생활별 추천시기 데이터가 없습니다. 먼저 해운번호를 입력하고 그래프를 생성해주세요.');
                return;
            }
            
            // 텍스트 형태로 변환
            let text = generateLifeRecommendationText();
            
            // 클립보드에 복사
            navigator.clipboard.writeText(text).then(() => {
                // 복사 완료 메시지 표시
                const status = document.getElementById('lifeCopyStatus');
                status.style.display = 'inline-block';
                setTimeout(() => {
                    status.style.display = 'none';
                }, 2000);
            }).catch(err => {
                // 복사 실패 시 대체 방법
                const textArea = document.createElement('textarea');
                textArea.value = text;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                
                const status = document.getElementById('lifeCopyStatus');
                status.style.display = 'inline-block';
                setTimeout(() => {
                    status.style.display = 'none';
                }, 2000);
            });
        }

        // 생활별 추천시기 텍스트 생성 함수
        function generateLifeRecommendationText() {
            const haeun1 = document.getElementById('haeun1').value.trim();
            const haeun2 = document.getElementById('haeun2').value.trim();
            const currentDate = new Date().toLocaleDateString('ko-KR');
            
            // 10년간 데이터 재생성 (복사용)
            const yearDetails = [];
            for (let i = 0; i < 10; i++) {
                const year = 2025 + i;
                const calculatedHaeun1 = calculateHaeun(haeun1, i);
                const calculatedHaeun2 = calculateHaeun(haeun2, i);
                const score1 = getScore(calculatedHaeun1);
                const score2 = getScore(calculatedHaeun2);
                const combinedScore = Math.round((score1 + score2) / 2);
                
                yearDetails.push({
                    year: year,
                    haeun1: calculatedHaeun1,
                    haeun2: calculatedHaeun2,
                    score1: score1,
                    score2: score2,
                    combinedScore: combinedScore,
                    meaning1: getMeaning(calculatedHaeun1),
                    meaning2: getMeaning(calculatedHaeun2)
                });
            }
            
            let text = `📅 생활별 추천시기 가이드
생성일: ${currentDate}
입력 해운번호: ${haeun1} / ${haeun2}

═══════════════════════════════════════════════════

`;

            // 생활 분야별 분석
            const categories = [
                { id: 'business', title: '💼 사업/창업', description: '새로운 사업 시작이나 사업 확장에 적합한 시기' },
                { id: 'investment', title: '💰 투자/재테크', description: '투자 결정이나 재정 관리에 유리한 시기' },
                { id: 'marriage', title: '💒 결혼/연애', description: '결혼이나 중요한 연애 결정에 좋은 시기' },
                { id: 'moving', title: '🏠 이사/이직', description: '거주지 변경이나 직장 이동에 적합한 시기' },
                { id: 'study', title: '📚 학습/자기계발', description: '새로운 공부나 기술 습득에 집중하기 좋은 시기' },
                { id: 'health', title: '🏥 건강관리', description: '건강 점검이나 치료에 신경써야 할 시기' }
            ];

            categories.forEach((category, index) => {
                const analysis = analyzeLifeCategory(yearDetails, category.id);
                
                text += `${category.title}
${category.description}

📊 10년 종합 분석:
${analysis.summary}

년도별 상세 분석:
`;
                
                // 점수 순으로 정렬된 추천사항들
                analysis.recommendations.forEach(rec => {
                    const levelText = {
                        'excellent': '🟢 최적기',
                        'good': '🔵 좋음',
                        'caution': '🟡 신중',
                        'avoid': '🔴 보류'
                    }[rec.level];
                    
                    text += `• ${rec.year}년 - ${levelText} (${rec.score}점)
  ${rec.reason}

`;
                });
                
                // 마지막 카테고리가 아니면 구분선 추가
                if (index < categories.length - 1) {
                    text += `───────────────────────────────────────────────────

`;
                }
            });
            
            text += `═══════════════════════════════════════════════════

💡 활용 가이드:
🟢 최적기: 적극적으로 추진하기 좋은 시기
🔵 좋음: 추천하는 시기, 계획적으로 진행
🟡 신중: 신중하게 판단하여 진행
🔴 보류: 피하거나 연기하는 것이 좋은 시기

※ 이 분석은 해운번호를 기반으로 한 참고 자료입니다.
※ 실제 결정은 개인의 상황과 판단을 종합하여 내리시기 바랍니다.

생성일시: ${new Date().toLocaleString('ko-KR')}`;

            return text;
        }

        // 생활별 추천시기 표시 함수
        function displayLifeRecommendations(yearDetails) {
            const section = document.getElementById('lifeRecommendationSection');
            const content = document.getElementById('lifeRecommendationsContent');
            
            // 생활 분야별 분석
            const categories = [
                {
                    id: 'business',
                    title: '💼 사업/창업',
                    icon: '💼',
                    description: '새로운 사업 시작이나 사업 확장에 적합한 시기'
                },
                {
                    id: 'investment',
                    title: '💰 투자/재테크',
                    icon: '💰',
                    description: '투자 결정이나 재정 관리에 유리한 시기'
                },
                {
                    id: 'marriage',
                    title: '💒 결혼/연애',
                    icon: '💒',
                    description: '결혼이나 중요한 연애 결정에 좋은 시기'
                },
                {
                    id: 'moving',
                    title: '🏠 이사/이직',
                    icon: '🏠',
                    description: '거주지 변경이나 직장 이동에 적합한 시기'
                },
                {
                    id: 'study',
                    title: '📚 학습/자기계발',
                    icon: '📚',
                    description: '새로운 공부나 기술 습득에 집중하기 좋은 시기'
                },
                {
                    id: 'health',
                    title: '🏥 건강관리',
                    icon: '🏥',
                    description: '건강 점검이나 치료에 신경써야 할 시기'
                }
            ];
            
            let html = '';
            
            categories.forEach(category => {
                const analysis = analyzeLifeCategory(yearDetails, category.id);
                
                html += `
                    <div class="life-category">
                        <h3 class="life-category-title">${category.title}</h3>
                        <div class="timing-summary">
                            <h4>📊 10년 종합 분석</h4>
                            <p>${analysis.summary}</p>
                        </div>
                        <div class="timing-grid">
                            ${analysis.recommendations.map(rec => `
                                <div class="timing-item ${rec.level}">
                                    <div class="timing-badge ${rec.level}">${rec.badge}</div>
                                    <div class="timing-year">${rec.year}년</div>
                                    <div class="timing-score">종합점수: ${rec.score}점</div>
                                    <div class="timing-reason">${rec.reason}</div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
            });
            
            content.innerHTML = html;
            section.style.display = 'block';
        }
        
        // 생활 분야별 분석 함수
        function analyzeLifeCategory(yearDetails, categoryId) {
            const recommendations = [];
            let summary = '';
            
            yearDetails.forEach(detail => {
                const analysis = getCategoryAnalysis(detail, categoryId);
                recommendations.push({
                    year: detail.year,
                    score: detail.combinedScore,
                    level: analysis.level,
                    badge: analysis.badge,
                    reason: analysis.reason
                });
            });
            
            // 카테고리별 종합 분석
            const excellentYears = recommendations.filter(r => r.level === 'excellent').length;
            const goodYears = recommendations.filter(r => r.level === 'good').length;
            const cautionYears = recommendations.filter(r => r.level === 'caution').length;
            const avoidYears = recommendations.filter(r => r.level === 'avoid').length;
            
            switch(categoryId) {
                case 'business':
                    summary = `사업/창업에 최적인 해는 ${excellentYears}년, 좋은 해는 ${goodYears}년입니다. 특히 해운점수가 85점 이상인 해에는 적극적인 사업 확장을 고려해보세요.`;
                    break;
                case 'investment':
                    summary = `투자에 유리한 해는 총 ${excellentYears + goodYears}년입니다. 0/5 해운이 있는 해에는 신중한 투자 전략이 필요합니다.`;
                    break;
                case 'marriage':
                    summary = `결혼/연애에 좋은 해는 ${excellentYears + goodYears}년입니다. 해운점수가 높은 해일수록 인연 만남의 기회가 많아집니다.`;
                    break;
                case 'moving':
                    summary = `이사/이직에 적합한 해는 ${excellentYears + goodYears}년입니다. 변화의 해운(0으로 시작)이 있는 해에 특히 주목하세요.`;
                    break;
                case 'study':
                    summary = `학습/자기계발에 집중하기 좋은 해는 ${excellentYears + goodYears}년입니다. 새로운 시작의 기운이 있는 해에 도전해보세요.`;
                    break;
                case 'health':
                    summary = `건강관리에 신경써야 할 해는 ${cautionYears + avoidYears}년입니다. 해운점수가 낮은 해일수록 예방에 집중하세요.`;
                    break;
            }
            
            return {
                summary,
                recommendations: recommendations.sort((a, b) => b.score - a.score)
            };
        }
        
        // 카테고리별 상세 분석
        function getCategoryAnalysis(detail, categoryId) {
            const score = detail.combinedScore;
            const hasReset = detail.haeun1.startsWith('0/') || detail.haeun2.startsWith('0/');
            const haeunNumbers = [detail.haeun1, detail.haeun2];
            
            let level, badge, reason;
            
            switch(categoryId) {
                case 'business':
                    if (score >= 85) {
                        level = 'excellent';
                        badge = '최적기';
                        reason = '사업 운세가 매우 좋아 새로운 도전이나 확장에 최적의 시기입니다.';
                    } else if (score >= 75) {
                        level = 'good';
                        badge = '좋음';
                        reason = '안정적인 사업 운영과 점진적 성장에 적합한 시기입니다.';
                    } else if (score >= 65) {
                        level = 'caution';
                        badge = '신중';
                        reason = '신중한 계획과 준비가 필요한 시기입니다.';
                    } else {
                        level = 'avoid';
                        badge = '보류';
                        reason = '큰 결정보다는 기존 사업 안정화에 집중하는 것이 좋습니다.';
                    }
                    break;
                    
                case 'investment':
                    if (hasReset) {
                        level = 'caution';
                        badge = '신중';
                        reason = '새로운 시작의 해운으로 변화가 많아 신중한 투자가 필요합니다.';
                    } else if (score >= 80) {
                        level = 'excellent';
                        badge = '최적기';
                        reason = '재물운이 좋아 투자 수익을 기대할 수 있는 시기입니다.';
                    } else if (score >= 70) {
                        level = 'good';
                        badge = '좋음';
                        reason = '안정적인 투자와 자산 관리에 적합한 시기입니다.';
                    } else {
                        level = 'avoid';
                        badge = '보류';
                        reason = '투자보다는 저축과 안정적인 자산 관리에 집중하세요.';
                    }
                    break;
                    
                case 'marriage':
                    if (score >= 80) {
                        level = 'excellent';
                        badge = '최적기';
                        reason = '애정운이 좋아 결혼이나 중요한 연애 결정에 최적의 시기입니다.';
                    } else if (score >= 70) {
                        level = 'good';
                        badge = '좋음';
                        reason = '인연 만남이나 관계 발전에 좋은 시기입니다.';
                    } else if (score >= 60) {
                        level = 'caution';
                        badge = '신중';
                        reason = '서두르지 말고 신중하게 관계를 발전시켜 나가세요.';
                    } else {
                        level = 'avoid';
                        badge = '보류';
                        reason = '급한 결정보다는 자기 계발에 집중하는 시기입니다.';
                    }
                    break;
                    
                case 'moving':
                    if (hasReset) {
                        level = 'excellent';
                        badge = '최적기';
                        reason = '새로운 시작의 해운으로 이사나 이직에 매우 좋은 시기입니다.';
                    } else if (score >= 75) {
                        level = 'good';
                        badge = '좋음';
                        reason = '환경 변화에 적응하기 좋은 시기입니다.';
                    } else if (score >= 65) {
                        level = 'caution';
                        badge = '신중';
                        reason = '충분한 준비와 계획 후에 이동을 고려하세요.';
                    } else {
                        level = 'avoid';
                        badge = '보류';
                        reason = '현재 위치에서 안정을 찾는 것이 더 좋습니다.';
                    }
                    break;
                    
                case 'study':
                    if (hasReset || score >= 75) {
                        level = 'excellent';
                        badge = '최적기';
                        reason = '새로운 학습이나 기술 습득에 매우 좋은 시기입니다.';
                    } else if (score >= 65) {
                        level = 'good';
                        badge = '좋음';
                        reason = '꾸준한 학습과 자기계발에 적합한 시기입니다.';
                    } else if (score >= 55) {
                        level = 'caution';
                        badge = '신중';
                        reason = '기초를 다지는 학습에 집중하는 것이 좋습니다.';
                    } else {
                        level = 'avoid';
                        badge = '휴식';
                        reason = '무리한 학습보다는 휴식과 재충전의 시기입니다.';
                    }
                    break;
                    
                case 'health':
                    if (score >= 80) {
                        level = 'excellent';
                        badge = '좋음';
                        reason = '건강 상태가 좋아 활동적인 생활을 즐길 수 있습니다.';
                    } else if (score >= 70) {
                        level = 'good';
                        badge = '양호';
                        reason = '규칙적인 생활과 운동으로 건강을 유지하세요.';
                    } else if (score >= 60) {
                        level = 'caution';
                        badge = '주의';
                        reason = '건강 관리에 더욱 신경쓰고 정기 검진을 받으세요.';
                    } else {
                        level = 'avoid';
                        badge = '관리';
                        reason = '건강에 특별히 주의하고 무리하지 마세요.';
                    }
                    break;
            }
            
            return { level, badge, reason };
        }

        // 해운번호 계산
        function calculateHaeun(baseHaeun, yearOffset) {
            let [numerator, denominator] = baseHaeun.split('/').map(Number);
            
            for (let i = 0; i < yearOffset; i++) {
                numerator += 1;
                denominator += 1;
                
                // 리셋 조건
                if (numerator === 10 && denominator === 18) {
                    numerator = 0; denominator = 9;
                } else if (numerator === 10 && denominator === 17) {
                    numerator = 0; denominator = 8;
                } else if (numerator === 10 && denominator === 16) {
                    numerator = 0; denominator = 7;
                } else if (numerator === 10 && denominator === 15) {
                    numerator = 0; denominator = 6;
                } else if (numerator === 10 && denominator === 14) {
                    numerator = 0; denominator = 5;
                }
            }
            
            return `${numerator}/${denominator}`;
        }

        // 점수 계산 (추정 포함)
        function getScore(haeun) {
            if (haeunDatabase[haeun]) {
                return haeunDatabase[haeun].score;
            }
            
            // 추정 로직 (모든 해운번호 대응)
            let [num, den] = haeun.split('/').map(Number);
            let baseScore = 60;
            
            // 분자에 따른 점수 조정
            if (num === 0) baseScore += 10; // 새로운 시작
            else if (num === 1) baseScore += 20; // 실체 있는 변화
            else if (num === 2) baseScore += 5; // 준비 단계
            else if (num === 3) baseScore += 15; // 보상 단계
            else if (num === 4) baseScore += 18; // 실천 단계
            else if (num === 5) baseScore += 10; // 주도 단계
            else if (num === 6) baseScore += 20; // 갈등 극복
            else if (num === 7) baseScore += 15; // 결정 단계
            else if (num === 8) baseScore += 0; // 이미지 형성
            else if (num === 9) baseScore += 25; // 변화 완성
            
            // 분모에 따른 조정
            baseScore += Math.floor(den / 2);
            
            return Math.min(95, Math.max(55, baseScore));
        }

        // 의미 추정
        function getMeaning(haeun) {
            if (haeunDatabase[haeun]) {
                return haeunDatabase[haeun].meaning;
            }
            
            let [num, den] = haeun.split('/').map(Number);
            const meanings = {
                0: "새로운 시작과 변화의 시기",
                1: "실질적인 발전과 성장",
                2: "준비와 도약의 단계",
                3: "보상과 결실의 시기",
                4: "실천과 행동의 중요성",
                5: "주도적인 결정의 시기",
                6: "갈등 극복과 선택의 시기",
                7: "결정과 이동의 단계",
                8: "이미지 형성과 평행 유지",
                9: "변화 완성과 새로운 준비"
            };
            
            return meanings[num] || "운세 변화의 시기";
        }

        // 그래프 생성 메인 함수
        function generateGraph() {
            const haeun1 = document.getElementById('haeun1').value.trim();
            const haeun2 = document.getElementById('haeun2').value.trim();
            
            // 입력 검증
            if (!haeun1 || !haeun2) {
                showError('두 개의 해운번호를 모두 입력해주세요.');
                return;
            }
            
            if (!validateHaeun(haeun1)) {
                showError('첫 번째 해운번호 형식이 올바르지 않습니다. (예: 9/16)');
                return;
            }
            
            if (!validateHaeun(haeun2)) {
                showError('두 번째 해운번호 형식이 올바르지 않습니다. (예: 5/11)');
                return;
            }
            
            // 10년간 데이터 생성
            const years = [];
            const combinedScores = [];
            const yearDetails = [];
            
            for (let i = 0; i < 10; i++) {
                const year = 2025 + i;
                years.push(year);
                
                const calculatedHaeun1 = calculateHaeun(haeun1, i);
                const calculatedHaeun2 = calculateHaeun(haeun2, i);
                const score1 = getScore(calculatedHaeun1);
                const score2 = getScore(calculatedHaeun2);
                const combinedScore = Math.round((score1 + score2) / 2);
                
                combinedScores.push(combinedScore);
                
                let specialType = '';
                if (calculatedHaeun1.startsWith('0/') || calculatedHaeun2.startsWith('0/')) {
                    specialType = 'reset';
                }
                if (combinedScore >= 85) {
                    specialType = 'peak';
                }
                
                yearDetails.push({
                    year: year,
                    haeun1: calculatedHaeun1,
                    haeun2: calculatedHaeun2,
                    score1: score1,
                    score2: score2,
                    combinedScore: combinedScore,
                    meaning1: getMeaning(calculatedHaeun1),
                    meaning2: getMeaning(calculatedHaeun2),
                    specialType: specialType
                });
            }
            
            // 통계 계산
            const maxScore = Math.max(...combinedScores);
            const minScore = Math.min(...combinedScores);
            const avgScore = Math.round(combinedScores.reduce((a, b) => a + b, 0) / combinedScores.length);
            const bestYearIndex = combinedScores.findIndex(score => score === maxScore);
            const worstYearIndex = combinedScores.findIndex(score => score === minScore);
            
            // 요약 정보 업데이트
            document.getElementById('bestYear').innerHTML = `${years[bestYearIndex]}년<br>${maxScore}점`;
            document.getElementById('avgScore').innerHTML = `${avgScore}점<br>전체 평균`;
            document.getElementById('cautionYear').innerHTML = `${years[worstYearIndex]}년<br>${minScore}점`;
            
            // 그래프 생성
            createChart(years, combinedScores, yearDetails, haeun1, haeun2);
            
            // 상세 정보 표시
            displayYearDetails(yearDetails);
            
            // 해운 풀이 표시 (10년치 년도별)
            displayAllYearHaeunDetails(yearDetails);
            
            // 생활별 추천시기 표시
            displayLifeRecommendations(yearDetails);
            
            // 결과 섹션 표시
            document.getElementById('resultSection').style.display = 'block';
            
            // 결과 섹션으로 스크롤
            document.getElementById('resultSection').scrollIntoView({ 
                behavior: 'smooth' 
            });
        }

        // 차트 생성
        function createChart(years, scores, details, baseHaeun1, baseHaeun2) {
            const ctx = document.getElementById('haeunChart').getContext('2d');
            
            // 기존 차트 제거
            if (currentChart) {
                currentChart.destroy();
            }
            
            currentChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: years,
                    datasets: [{
                        label: `종합 해운 (${baseHaeun1} + ${baseHaeun2})`,
                        data: scores,
                        borderColor: '#667eea',
                        backgroundColor: 'rgba(102, 126, 234, 0.1)',
                        borderWidth: 5,
                        fill: true,
                        tension: 0.4,
                        pointBackgroundColor: scores.map(score => {
                            if (score >= 85) return '#ffd700';
                            if (score >= 75) return '#4ecdc4';
                            if (score >= 65) return '#ff9800';
                            return '#f44336';
                        }),
                        pointBorderColor: '#fff',
                        pointBorderWidth: 3,
                        pointRadius: 10,
                        pointHoverRadius: 12
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0,0,0,0.9)',
                            titleColor: '#fff',
                            titleFont: { size: 16, weight: 'bold' },
                            bodyColor: '#fff',
                            bodyFont: { size: 13 },
                            borderColor: '#667eea',
                            borderWidth: 2,
                            padding: 15,
                            callbacks: {
                                title: function(context) {
                                    return `${context[0].label}년 종합 운세`;
                                },
                                label: function(context) {
                                    const index = context.dataIndex;
                                    const detail = details[index];
                                    return [
                                        `종합 점수: ${detail.combinedScore}점`,
                                        `${baseHaeun1} → ${detail.haeun1} (${detail.score1}점)`,
                                        `${baseHaeun2} → ${detail.haeun2} (${detail.score2}점)`,
                                        `주요 의미: ${detail.meaning1}`
                                    ];
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: false,
                            min: 50,
                            max: 100,
                            grid: {
                                color: 'rgba(102, 126, 234, 0.1)',
                                drawBorder: false
                            },
                            ticks: {
                                font: { size: 13 },
                                callback: function(value) {
                                    return value + '점';
                                }
                            }
                        },
                        x: {
                            grid: {
                                color: 'rgba(102, 126, 234, 0.05)',
                                drawBorder: false
                            },
                            ticks: {
                                font: { size: 13 }
                            }
                        }
                    },
                    interaction: {
                        intersect: false,
                        mode: 'index'
                    }
                }
            });
        }

        // 상세 정보 표시
        function displayYearDetails(details) {
            const container = document.getElementById('yearDetails');
            let html = '';
            
            details.forEach(detail => {
                const scoreClass = detail.combinedScore >= 80 ? 'score-high' : 
                                detail.combinedScore >= 70 ? 'score-medium' : 'score-low';
                
                const cardClass = detail.specialType === 'peak' ? 'peak' : 
                                detail.specialType === 'reset' ? 'reset' : '';
                
                html += `
                    <div class="year-card ${cardClass}">
                        <strong>${detail.year}년</strong>
                        ${detail.specialType === 'peak' ? '👑' : ''}
                        ${detail.specialType === 'reset' ? '🔄' : ''}
                        <div style="font-size: 18px; margin: 8px 0;">
                            종합: <span class="${scoreClass}">${detail.combinedScore}점</span>
                        </div>
                        <hr style="margin: 10px 0; border: none; border-top: 1px solid #eee;">
                        <div style="font-size: 12px; margin-bottom: 5px;">
                            ${detail.haeun1} (${detail.score1}점)
                        </div>
                        <div style="font-size: 12px; margin-bottom: 8px;">
                            ${detail.haeun2} (${detail.score2}점)
                        </div>
                        <div style="font-size: 10px; color: #666; line-height: 1.3;">
                            ${detail.meaning1}
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }

        // 10년치 해운 상세 풀이 표시 (텍스트 복사용)
        function displayAllYearHaeunDetails(yearDetails) {
            const section = document.getElementById('haeunDetailSection');
            const content = document.getElementById('haeunDetailContent');
            
            // 복사 버튼과 제목 추가
            let html = `
                <div class="copy-section">
                    <button class="copy-btn" onclick="copyHaeunText()">📋 해운풀이 텍스트 복사</button>
                    <div class="copy-status" id="copyStatus" style="display: none;">복사 완료! ✅</div>
                </div>
                <div id="haeunTextContent" class="haeun-text-content">
            `;
            
            // 제목 추가
            html += `
                <div class="document-title">
                    <h3>🔮 10년간 해운번호 상세 풀이</h3>
                    <div class="document-subtitle">생성일: ${new Date().toLocaleDateString('ko-KR')}</div>
                </div>
            `;
            
            // 각 년도별 해운 풀이
            yearDetails.forEach((detail, index) => {
                const haeunData1 = haeunDatabase[detail.haeun1];
                const haeunData2 = haeunDatabase[detail.haeun2];
                
                html += `
                    <div class="year-fortune-section">
                        <div class="year-header">
                            <h4>📅 ${detail.year}년 해운 분석</h4>
                            <div class="year-summary">
                                종합점수: ${detail.combinedScore}점 | 
                                첫 번째 해운: ${detail.haeun1} (${detail.score1}점) | 
                                두 번째 해운: ${detail.haeun2} (${detail.score2}점)
                            </div>
                        </div>
                        
                        <div class="haeun-details">
                            <div class="haeun-block">
                                <h5>🎯 첫 번째 해운: ${detail.haeun1}</h5>
                                <div class="haeun-meaning">의미: ${detail.meaning1}</div>
                                ${generateHaeunDetailText(detail.haeun1, haeunData1)}
                            </div>
                            
                            <div class="haeun-block">
                                <h5>🎯 두 번째 해운: ${detail.haeun2}</h5>
                                <div class="haeun-meaning">의미: ${detail.meaning2}</div>
                                ${generateHaeunDetailText(detail.haeun2, haeunData2)}
                            </div>
                        </div>
                        
                        <div class="year-divider">────────────────────────────────────</div>
                    </div>
                `;
            });
            
            html += '</div>'; // haeunTextContent 종료
            
            content.innerHTML = html;
            section.style.display = 'block';
        }
        
        // 개별 해운 상세 텍스트 생성
        function generateHaeunDetailText(haeunNumber, haeunData) {
            if (!haeunData || !haeunData.general) {
                return `<div class="no-detail">상세 풀이 준비 중입니다.</div>`;
            }
            
            let html = `
                <div class="general-info">
                    <strong>📖 전체 운세:</strong><br>
                    ${haeunData.general}
                </div>
            `;
            
            // 4가지 운세 영역 (텍스트 형태)
            if (haeunData.money) {
                html += `
                    <div class="fortune-detail">
                        <strong>💰 ${haeunData.money.title}:</strong><br>
                        ${haeunData.money.content}
                        ${haeunData.money.example ? `<br><em>예시: ${haeunData.money.example}</em>` : ''}
                    </div>
                `;
            }
            
            if (haeunData.love) {
                html += `
                    <div class="fortune-detail">
                        <strong>💕 ${haeunData.love.title}:</strong><br>
                        ${haeunData.love.content}
                        ${haeunData.love.example ? `<br><em>예시: ${haeunData.love.example}</em>` : ''}
                    </div>
                `;
            }
            
            if (haeunData.work) {
                html += `
                    <div class="fortune-detail">
                        <strong>💼 ${haeunData.work.title}:</strong><br>
                        ${haeunData.work.content}
                        ${haeunData.work.example ? `<br><em>예시: ${haeunData.work.example}</em>` : ''}
                    </div>
                `;
            }
            
            if (haeunData.health) {
                html += `
                    <div class="fortune-detail">
                        <strong>🏥 ${haeunData.health.title}:</strong><br>
                        ${haeunData.health.content}
                        ${haeunData.health.warning ? `<br><strong>⚠️ 주의: ${haeunData.health.warning}</strong>` : ''}
                    </div>
                `;
            }
            
            // 조언 섹션
            if (haeunData.todo && haeunData.todo.length > 0) {
                html += `
                    <div class="advice-detail">
                        <strong>✅ 추천 행동:</strong><br>
                        ${haeunData.todo.map((item, index) => `${index + 1}. ${item}`).join('<br>')}
                    </div>
                `;
            }
            
            if (haeunData.caution && haeunData.caution.length > 0) {
                html += `
                    <div class="advice-detail">
                        <strong>⚠️ 주의사항:</strong><br>
                        ${haeunData.caution.map((item, index) => `${index + 1}. ${item}`).join('<br>')}
                    </div>
                `;
            }
            
            return html;
        }
        
        // 텍스트 복사 함수
        function copyHaeunText() {
            const content = document.getElementById('haeunTextContent');
            const text = content.innerText || content.textContent;
            
            // 클립보드에 복사
            navigator.clipboard.writeText(text).then(() => {
                // 복사 완료 메시지 표시
                const status = document.getElementById('copyStatus');
                status.style.display = 'inline-block';
                setTimeout(() => {
                    status.style.display = 'none';
                }, 2000);
            }).catch(err => {
                // 복사 실패 시 대체 방법
                const textArea = document.createElement('textarea');
                textArea.value = text;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                
                const status = document.getElementById('copyStatus');
                status.style.display = 'inline-block';
                setTimeout(() => {
                    status.style.display = 'none';
                }, 2000);
            });
        }
        
        // 해운 상세 풀이 표시 (기존 함수 - 사용하지 않음)
        function displayHaeunDetail(haeunNumber, haeunData) {
            const section = document.getElementById('haeunDetailSection');
            const content = document.getElementById('haeunDetailContent');
            
            if (!haeunData || !haeunData.general) {
                section.style.display = 'none';
                return;
            }
            
            let html = `
                <div class="haeun-overview">
                    <h4>해운번호 ${haeunNumber} (${haeunData.score}점)</h4>
                    <div class="meaning">${haeunData.meaning}</div>
                    <div class="general">${haeunData.general}</div>
                </div>
            `;
            
            // 4가지 운세 영역
            if (haeunData.money || haeunData.love || haeunData.work || haeunData.health) {
                html += '<div class="fortune-grid">';
                
                // 재물운
                if (haeunData.money) {
                    html += `
                        <div class="fortune-card">
                            <h5>💰 ${haeunData.money.title}</h5>
                            <div class="content">${haeunData.money.content}</div>
                            ${haeunData.money.example ? `<div class="example">📝 ${haeunData.money.example}</div>` : ''}
                        </div>
                    `;
                }
                
                // 애정운
                if (haeunData.love) {
                    html += `
                        <div class="fortune-card">
                            <h5>💕 ${haeunData.love.title}</h5>
                            <div class="content">${haeunData.love.content}</div>
                            ${haeunData.love.example ? `<div class="example">📝 ${haeunData.love.example}</div>` : ''}
                        </div>
                    `;
                }
                
                // 직장운
                if (haeunData.work) {
                    html += `
                        <div class="fortune-card">
                            <h5>💼 ${haeunData.work.title}</h5>
                            <div class="content">${haeunData.work.content}</div>
                            ${haeunData.work.example ? `<div class="example">📝 ${haeunData.work.example}</div>` : ''}
                        </div>
                    `;
                }
                
                // 건강운
                if (haeunData.health) {
                    html += `
                        <div class="fortune-card">
                            <h5>🏥 ${haeunData.health.title}</h5>
                            <div class="content">${haeunData.health.content}</div>
                            ${haeunData.health.warning ? `<div class="warning">⚠️ ${haeunData.health.warning}</div>` : ''}
                        </div>
                    `;
                }
                
                html += '</div>';
            }
            
            // 조언 섹션 (할 일과 주의사항)
            if ((haeunData.todo && haeunData.todo.length > 0) || (haeunData.caution && haeunData.caution.length > 0)) {
                html += '<div class="advice-section">';
                
                // 할 일
                if (haeunData.todo && haeunData.todo.length > 0) {
                    html += `
                        <div class="advice-card todo-card">
                            <h5>✅ 추천 행동</h5>
                            <ul class="advice-list">
                                ${haeunData.todo.map(item => `<li>${item}</li>`).join('')}
                            </ul>
                        </div>
                    `;
                }
                
                // 주의사항
                if (haeunData.caution && haeunData.caution.length > 0) {
                    html += `
                        <div class="advice-card caution-card">
                            <h5>⚠️ 주의사항</h5>
                            <ul class="advice-list">
                                ${haeunData.caution.map(item => `<li>${item}</li>`).join('')}
                            </ul>
                        </div>
                    `;
                }
                
                html += '</div>';
            }
            
            content.innerHTML = html;
            section.style.display = 'block';
        }

        // 탭 전환 함수
        function showTab(tabName) {
            // 모든 탭 버튼 비활성화
            document.querySelectorAll('.tab-button').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // 모든 탭 컨텐츠 숨기기
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // 선택된 탭 활성화
            event.target.classList.add('active');
            document.getElementById(tabName + '-tab').classList.add('active');
        }

        // 행운 분석 데이터베이스
        const colorDatabase = {
            1: [
                { name: '골드', code: '#FFD700' },
                { name: '화이트', code: '#FFFFFF' },
                { name: '초록', code: '#4CAF50' }
            ],
            2: [
                { name: '화이트', code: '#FFFFFF' },
                { name: '분홍', code: '#FF69B4' },
                { name: '파랑', code: '#2196F3' }
            ],
            3: [
                { name: '분홍', code: '#FF69B4' },
                { name: '화이트', code: '#FFFFFF' },
                { name: '초록', code: '#4CAF50' }
            ],
            4: [
                { name: '청록', code: '#00BCD4' },
                { name: '블랙', code: '#000000' }
            ],
            5: [
                { name: '분홍', code: '#FF69B4' },
                { name: '화이트', code: '#FFFFFF' },
                { name: '초록', code: '#4CAF50' }
            ],
            6: [
                { name: '블랙', code: '#000000' }
            ],
            7: [
                { name: '블랙', code: '#000000' },
                { name: '화이트', code: '#FFFFFF' }
            ],
            8: [
                { name: '블랙', code: '#000000' }
            ],
            9: [
                { name: '골드', code: '#FFD700' },
                { name: '화이트', code: '#FFFFFF' },
                { name: '초록', code: '#4CAF50' }
            ],
            10: [
                { name: '민트', code: '#00C896' },
                { name: '하늘', code: '#87CEEB' },
                { name: '화이트', code: '#FFFFFF' }
            ],
            11: [
                { name: '블랙', code: '#000000' },
                { name: '골드', code: '#FFD700' }
            ],
            12: [
                { name: '블랙', code: '#000000' }
            ],
            13: [
                { name: '분홍', code: '#FF69B4' },
                { name: '블랙', code: '#000000' }
            ],
            14: [
                { name: '블랙', code: '#000000' },
                { name: '화이트', code: '#FFFFFF' }
            ],
            15: [
                { name: '블랙', code: '#000000' },
                { name: '화이트', code: '#FFFFFF' }
            ],
            16: [
                { name: '블랙', code: '#000000' }
            ],
            17: [
                { name: '골드', code: '#FFD700' },
                { name: '화이트', code: '#FFFFFF' },
                { name: '초록', code: '#4CAF50' },
                { name: '민트', code: '#00C896' },
                { name: '하늘', code: '#87CEEB' }
            ],
            18: [
                { name: '민트', code: '#00C896' },
                { name: '하늘', code: '#87CEEB' },
                { name: '화이트', code: '#FFFFFF' },
                { name: '골드', code: '#FFD700' }
            ],
            19: [
                { name: '블랙', code: '#000000' }
            ],
            20: [
                { name: '화이트', code: '#FFFFFF' },
                { name: '분홍', code: '#FF69B4' },
                { name: '파랑', code: '#2196F3' }
            ],
            21: [
                { name: '분홍', code: '#FF69B4' },
                { name: '화이트', code: '#FFFFFF' },
                { name: '초록', code: '#4CAF50' }
            ]
        };

        const chosungDatabase = {
            2: { chosung: ['ㄱ', 'ㄴ', 'ㅇ'], special: ['물'] },
            3: { chosung: ['ㄴ', 'ㄷ', 'ㅁ', 'ㅂ'], special: ['언덕'] },
            4: { chosung: ['ㄷ', 'ㅅ'], special: [] },
            5: { chosung: ['ㄷ', 'ㅂ'], special: [] },
            6: { chosung: ['ㄱ', 'ㄴ', 'ㅇ'], special: [] },
            7: { chosung: ['ㄷ', 'ㅈ'], special: [] },
            8: { chosung: ['ㄱ', 'ㅂ', 'ㅅ'], special: ['중앙'] },
            9: { chosung: ['ㅅ', 'ㅇ', 'ㅈ', 'ㅎ'], special: ['북쪽'] },
            10: { chosung: ['ㄴ'], special: [] },
            11: { chosung: ['ㄱ', 'ㄴ', 'ㅂ', 'ㅅ'], special: [] }
        };

        const regionDatabase = {
            'ㄱ': {
                '서울': ['강남구', '강동구', '강북구', '강서구', '관악구', '광진구', '구로구', '금천구'],
                '경기도': ['고양시', '구리시', '군포시', '김포시', '광명시', '과천시', '광주시'],
                '강원도': ['강릉시', '고성군'],
                '경상도': ['경주시', '거제시', '김해시', '김천시', '거창군', '고령군', '고성군', '구미시'],
                '전라도': ['광주광역시', '고창군', '곡성군', '구례군', '김제시'],
                '충청도': ['공주시', '금산군', '계룡시']
            },
            'ㄴ': {
                '서울': ['노원구'],
                '경기도': ['남양주시'],
                '전라도': ['나주시', '남원시'],
                '충청도': ['논산시']
            },
            'ㄷ': {
                '서울': ['동대문구', '동작구', '도봉구'],
                '경기도': ['동두천시'],
                '강원도': ['동해시'],
                '경상도': ['대구광역시', '대구 동구', '대구 달서구'],
                '충청도': ['대전광역시', '당진시', '단양군']
            },
            'ㅁ': {
                '서울': ['마포구'],
                '전라도': ['목포시', '무안군', '무주군'],
                '경상도': ['문경시', '밀양시', '마산시']
            },
            'ㅂ': {
                '경상도': ['부산광역시', '부산 북구', '부산 부산진구', '부산 사하구', '봉화군'],
                '경기도': ['부천시', '분당구'],
                '충청도': ['보령시', '부여군', '보은군']
            },
            'ㅅ': {
                '서울': ['서대문구', '서초구', '성동구', '성북구', '송파구'],
                '경기도': ['수원시', '성남시', '시흥시', '산본', '수지구'],
                '강원도': ['속초시', '삼척시', '설악산'],
                '경상도': ['상주시', '사천시', '산청군'],
                '충청도': ['서산시', '서천군'],
                '전라도': ['순천시', '순창군']
            },
            'ㅇ': {
                '서울': ['용산구', '양천구', '영등포구', '은평구'],
                '경기도': ['용인시', '의정부시', '안양시', '안산시', '안성시', '의왕시', '양평군', '양주시', '여주시', '연천군', '오산시'],
                '강원도': ['원주시', '양구군', '양양군', '영월군', '인제군'],
                '경상도': ['울산광역시', '울진군', '영천시', '영덕군', '영양군', '영주시', '예천군', '의령군', '의성군'],
                '전라도': ['여수시', '익산시', '영광군', '영암군', '완주군'],
                '충청도': ['아산시', '예산군', '연기군', '영동군', '옥천군', '음성군'],
                '기타': ['인천광역시', '인천 연수구', '인천 옹진군']
            },
            'ㅈ': {
                '서울': ['종로구', '중구', '중랑구'],
                '전라도': ['전주시', '진주시', '정읍시', '장수군', '장성군', '장흥군', '진도군', '진안군'],
                '충청도': ['제천시', '증평군', '진천군', '청양군', '청주시'],
                '경상도': ['진해시', '창원시', '창녕군'],
                '강원도': ['정선군', '철원군']
            },
            'ㅎ': {
                '경기도': ['화성시', '하남시'],
                '충청도': ['홍성군', '홍천군'],
                '경상도': ['합천군', '하동군', '함안군', '함양군'],
                '전라도': ['해남군', '화순군', '함평군'],
                '강원도': ['홍천군', '화천군', '횡성군']
            }
        };

        const waterRegions = ['강남구', '강동구', '강북구', '강서구', '강릉시', '강화군', '한강', '낙동강', '금강', '영산강', '섬진강', '해운대구', '해남군'];
        const centerRegions = ['중구', '중랑구', '중원구', '중앙동', '중앙로'];
        const northRegions = ['북구', '북한산', '강북구', '북면', '북부'];
        const fortuneLuckyNumbers = [1, 3, 4, 5, 6, 7, 10, 11, 14, 17, 19, 21];

        // 사주번호 관련 코드
        const sajuScores = {
            1: { money: 85, love: 95, work: 80, health: 70, social: 90, creative: 85 },
            2: { money: 75, love: 60, work: 90, health: 75, social: 70, creative: 65 },
            3: { money: 80, love: 85, work: 75, health: 65, social: 85, creative: 90 },
            4: { money: 90, love: 65, work: 95, health: 80, social: 70, creative: 60 },
            5: { money: 70, love: 80, work: 85, health: 70, social: 80, creative: 75 },
            6: { money: 75, love: 95, work: 70, health: 60, social: 95, creative: 95 },
            7: { money: 85, love: 90, work: 85, health: 75, social: 80, creative: 70 },
            8: { money: 75, love: 75, work: 80, health: 85, social: 75, creative: 65 },
            9: { money: 80, love: 70, work: 85, health: 70, social: 65, creative: 85 },
            10: { money: 85, love: 90, work: 80, health: 65, social: 90, creative: 80 },
            11: { money: 80, love: 70, work: 90, health: 75, social: 75, creative: 70 },
            12: { money: 70, love: 75, work: 75, health: 60, social: 80, creative: 95 },
            13: { money: 85, love: 80, work: 85, health: 70, social: 75, creative: 75 },
            14: { money: 80, love: 90, work: 80, health: 70, social: 85, creative: 70 },
            15: { money: 65, love: 70, work: 65, health: 55, social: 85, creative: 90 },
            16: { money: 75, love: 75, work: 80, health: 65, social: 70, creative: 60 },
            17: { money: 90, love: 95, work: 85, health: 80, social: 95, creative: 90 },
            18: { money: 70, love: 65, work: 75, health: 60, social: 60, creative: 80 },
            19: { money: 85, love: 85, work: 85, health: 75, social: 75, creative: 85 },
            20: { money: 80, love: 85, work: 90, health: 70, social: 80, creative: 85 },
            21: { money: 90, love: 90, work: 90, health: 80, social: 90, creative: 85 }
        };

        let animationId = null;
        let currentValues = [0, 0, 0, 0, 0, 0];
        let targetValues = [0, 0, 0, 0, 0, 0];

        function drawRadarChart(canvas, data, labels, animated = true) {
            const ctx = canvas.getContext('2d');
            const centerX = canvas.width / 2;
            const centerY = canvas.height / 2;
            const radius = Math.min(centerX, centerY) - 100;
            const angleStep = (Math.PI * 2) / labels.length;

            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // Background decoration
            ctx.save();
            const bgGradient = ctx.createRadialGradient(centerX, centerY, 0, centerX, centerY, radius * 1.2);
            bgGradient.addColorStop(0, 'rgba(72, 207, 203, 0.02)');
            bgGradient.addColorStop(0.5, 'rgba(255, 107, 157, 0.02)');
            bgGradient.addColorStop(1, 'transparent');
            ctx.fillStyle = bgGradient;
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            ctx.restore();

            // Draw grid with gradient
            for (let i = 5; i >= 1; i--) {
                ctx.save();
                const gridGradient = ctx.createLinearGradient(centerX - radius, centerY, centerX + radius, centerY);
                gridGradient.addColorStop(0, `rgba(255, 107, 157, ${0.05 + (0.02 * (6 - i))})`);
                gridGradient.addColorStop(0.5, `rgba(72, 207, 203, ${0.05 + (0.02 * (6 - i))})`);
                gridGradient.addColorStop(1, `rgba(254, 87, 87, ${0.05 + (0.02 * (6 - i))})`);
                
                ctx.strokeStyle = gridGradient;
                ctx.lineWidth = 1.5;
                ctx.beginPath();
                for (let j = 0; j < labels.length; j++) {
                    const angle = j * angleStep - Math.PI / 2;
                    const x = centerX + Math.cos(angle) * radius * (i / 5);
                    const y = centerY + Math.sin(angle) * radius * (i / 5);
                    if (j === 0) ctx.moveTo(x, y);
                    else ctx.lineTo(x, y);
                }
                ctx.closePath();
                ctx.stroke();
                ctx.restore();

                // Scale numbers
                if (i % 2 === 1) {
                    ctx.fillStyle = '#94a3b8';
                    ctx.font = '13px "Noto Sans KR"';
                    ctx.textAlign = 'center';
                    ctx.fillText((i * 20).toString(), centerX + 5, centerY - radius * (i / 5) + 5);
                }
            }

            // Draw axes with gradient
            for (let i = 0; i < labels.length; i++) {
                const angle = i * angleStep - Math.PI / 2;
                
                ctx.save();
                const axisGradient = ctx.createLinearGradient(centerX, centerY, 
                    centerX + Math.cos(angle) * radius, 
                    centerY + Math.sin(angle) * radius);
                axisGradient.addColorStop(0, 'rgba(72, 207, 203, 0.2)');
                axisGradient.addColorStop(1, 'rgba(255, 107, 157, 0.1)');
                
                ctx.strokeStyle = axisGradient;
                ctx.lineWidth = 1;
                ctx.beginPath();
                ctx.moveTo(centerX, centerY);
                ctx.lineTo(
                    centerX + Math.cos(angle) * radius,
                    centerY + Math.sin(angle) * radius
                );
                ctx.stroke();
                ctx.restore();
            }

            // Draw labels with background
            ctx.fillStyle = '#334155';
            ctx.font = 'bold 15px "Noto Sans KR"';
            
            for (let i = 0; i < labels.length; i++) {
                const angle = i * angleStep - Math.PI / 2;
                const x = centerX + Math.cos(angle) * (radius + 50);
                const y = centerY + Math.sin(angle) * (radius + 50);
                
                // Label background
                ctx.save();
                ctx.fillStyle = 'rgba(255, 255, 255, 0.9)';
                const metrics = ctx.measureText(labels[i]);
                const padding = 8;
                ctx.fillRect(x - metrics.width/2 - padding, y - 10 - padding, 
                    metrics.width + padding*2, 20 + padding);
                ctx.restore();
                
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                ctx.fillText(labels[i], x, y);
            }

            // Animate values
            if (animated) {
                for (let i = 0; i < currentValues.length; i++) {
                    currentValues[i] += (targetValues[i] - currentValues[i]) * 0.12;
                }
            } else {
                currentValues = [...data];
            }

            // Draw data area with multiple gradients
            ctx.save();
            const dataGradient = ctx.createRadialGradient(centerX, centerY, 0, centerX, centerY, radius);
            dataGradient.addColorStop(0, 'rgba(72, 207, 203, 0.3)');
            dataGradient.addColorStop(0.5, 'rgba(255, 107, 157, 0.25)');
            dataGradient.addColorStop(1, 'rgba(254, 87, 87, 0.2)');
            
            ctx.fillStyle = dataGradient;
            
            ctx.beginPath();
            for (let i = 0; i < currentValues.length; i++) {
                const angle = i * angleStep - Math.PI / 2;
                const value = currentValues[i] / 100;
                const x = centerX + Math.cos(angle) * radius * value;
                const y = centerY + Math.sin(angle) * radius * value;
                if (i === 0) ctx.moveTo(x, y);
                else ctx.lineTo(x, y);
            }
            ctx.closePath();
            ctx.fill();
            
            // Draw outline with gradient
            const outlineGradient = ctx.createLinearGradient(0, 0, canvas.width, canvas.height);
            outlineGradient.addColorStop(0, '#FF6B9D');
            outlineGradient.addColorStop(0.5, '#48CFCB');
            outlineGradient.addColorStop(1, '#FE5757');
            
            ctx.strokeStyle = outlineGradient;
            ctx.lineWidth = 3;
            ctx.stroke();
            ctx.restore();

            // Draw points with glow effect
            for (let i = 0; i < currentValues.length; i++) {
                const angle = i * angleStep - Math.PI / 2;
                const value = currentValues[i] / 100;
                const x = centerX + Math.cos(angle) * radius * value;
                const y = centerY + Math.sin(angle) * radius * value;
                
                // Glow effect
                ctx.save();
                const glowGradient = ctx.createRadialGradient(x, y, 0, x, y, 20);
                glowGradient.addColorStop(0, 'rgba(72, 207, 203, 0.3)');
                glowGradient.addColorStop(1, 'transparent');
                ctx.fillStyle = glowGradient;
                ctx.fillRect(x - 20, y - 20, 40, 40);
                ctx.restore();
                
                // White background
                ctx.fillStyle = '#ffffff';
                ctx.beginPath();
                ctx.arc(x, y, 10, 0, Math.PI * 2);
                ctx.fill();
                ctx.strokeStyle = 'rgba(0, 0, 0, 0.1)';
                ctx.lineWidth = 1;
                ctx.stroke();
                
                // Colored point
                const pointGradient = ctx.createRadialGradient(x, y, 0, x, y, 7);
                pointGradient.addColorStop(0, '#48CFCB');
                pointGradient.addColorStop(1, '#FF6B9D');
                ctx.fillStyle = pointGradient;
                ctx.beginPath();
                ctx.arc(x, y, 6, 0, Math.PI * 2);
                ctx.fill();
                
                // Value label with background
                ctx.save();
                ctx.fillStyle = 'rgba(255, 255, 255, 0.95)';
                ctx.fillRect(x + 12, y - 12, 28, 20);
                
                ctx.fillStyle = '#334155';
                ctx.font = 'bold 13px "Noto Sans KR"';
                ctx.fillText(Math.round(currentValues[i]), x + 26, y);
                ctx.restore();
            }

            // Continue animation
            if (animated && Math.abs(currentValues[0] - targetValues[0]) > 0.1) {
                animationId = requestAnimationFrame(() => drawRadarChart(canvas, data, labels, animated));
            }
        }

        function updateSajuStats(avgScores, labels) {
            const container = document.getElementById('statsContainer');
            container.innerHTML = '';
            
            avgScores.forEach((score, index) => {
                const statItem = document.createElement('div');
                statItem.className = 'saju-stat-item';
                statItem.innerHTML = `
                    <div class="saju-stat-label">${labels[index]}</div>
                    <div class="saju-stat-value">${score}점</div>
                `;
                container.appendChild(statItem);
            });
        }

        function generateSajuChart() {
            const num1 = parseInt(document.getElementById('num1').value) || 20;
            const num2 = parseInt(document.getElementById('num2').value) || 4;
            const num3 = parseInt(document.getElementById('num3').value) || 8;
            const num4 = parseInt(document.getElementById('num4').value) || 10;

            if (!num1 || !num2 || !num3 || !num4) {
                alert('모든 사주번호를 입력해주세요!');
                return;
            }

            const scores1 = sajuScores[num1] || sajuScores[1];
            const scores2 = sajuScores[num2] || sajuScores[1];
            const scores3 = sajuScores[num3] || sajuScores[1];
            const scores4 = sajuScores[num4] || sajuScores[1];

            const avgScores = [
                Math.round((scores1.money + scores2.money + scores3.money + scores4.money) / 4),
                Math.round((scores1.love + scores2.love + scores3.love + scores4.love) / 4),
                Math.round((scores1.work + scores2.work + scores3.work + scores4.work) / 4),
                Math.round((scores1.health + scores2.health + scores3.health + scores4.health) / 4),
                Math.round((scores1.social + scores2.social + scores3.social + scores4.social) / 4),
                Math.round((scores1.creative + scores2.creative + scores3.creative + scores4.creative) / 4)
            ];

            const labels = ['재물운', '애정운', '직장운', '건강운', '대인관계', '창의성'];
            
            targetValues = [...avgScores];
            
            if (animationId) {
                cancelAnimationFrame(animationId);
            }
            
            const canvas = document.getElementById('radarChart');
            drawRadarChart(canvas, avgScores, labels, true);

            const totalScore = avgScores.reduce((a, b) => a + b, 0);
            const avgTotal = Math.round(totalScore / 6);
            document.getElementById('resultText').innerHTML = `종합 점수: <span>${avgTotal}점</span>`;
            
            updateSajuStats(avgScores, labels);
            
            // 행운 분석 실행
            analyzeFortune(num1, num2, num3, num4);
        }

        // 사주 행운 분석 텍스트 복사 함수
        function copySajuFortuneText() {
            const fortuneSection = document.getElementById('fortuneAnalysisSection');
            if (!fortuneSection || fortuneSection.style.display === 'none') {
                alert('행운 분석 데이터가 없습니다. 먼저 사주번호를 입력하고 분석을 실행해주세요.');
                return;
            }
            
            // 텍스트 형태로 변환
            let text = generateSajuFortuneText();
            
            // 클립보드에 복사
            navigator.clipboard.writeText(text).then(() => {
                // 복사 완료 메시지 표시
                const status = document.getElementById('sajuFortuneCopyStatus');
                status.style.display = 'inline-block';
                setTimeout(() => {
                    status.style.display = 'none';
                }, 2000);
            }).catch(err => {
                // 복사 실패 시 대체 방법
                const textArea = document.createElement('textarea');
                textArea.value = text;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                
                const status = document.getElementById('sajuFortuneCopyStatus');
                status.style.display = 'inline-block';
                setTimeout(() => {
                    status.style.display = 'none';
                }, 2000);
            });
        }

        // 사주 행운 분석 텍스트 생성 함수
        function generateSajuFortuneText() {
            const num1 = parseInt(document.getElementById('num1').value) || 20;
            const num2 = parseInt(document.getElementById('num2').value) || 4;
            const num3 = parseInt(document.getElementById('num3').value) || 8;
            const num4 = parseInt(document.getElementById('num4').value) || 10;
            const currentDate = new Date().toLocaleDateString('ko-KR');
            
            let text = `🌟 사주번호 행운 분석 결과
생성일: ${currentDate}
입력 사주번호: ${num1}, ${num2} / ${num3}, ${num4}

═══════════════════════════════════════════════════

🎰 행운의 숫자

`;

            // 행운의 숫자 생성
            const specialNumbers = [num1, num2, num3, num4];
            const allLuckyNumbers = [...new Set([...specialNumbers, ...fortuneLuckyNumbers])].sort((a, b) => a - b);
            
            text += `당신의 행운의 숫자들:
${allLuckyNumbers.join(', ')}

설명:
사주번호 ${num1}, ${num2} / ${num3}, ${num4}의 기운과 조화를 이루는 행운의 숫자들입니다. 이 숫자들은 일상생활에서 좋은 기운을 가져다 줄 수 있습니다.

활용법:
• 로또 번호 선택 시 참고
• 중요한 날짜나 시간 선택 시 활용
• 휴대폰 번호, 자동차 번호 등에 활용
• 비밀번호나 중요한 숫자 조합에 포함

───────────────────────────────────────────────────

🎨 행운의 색상

`;

            // 행운의 색상 생성
            const colors1 = colorDatabase[num1] || [];
            const colors2 = colorDatabase[num2] || [];
            const colors3 = colorDatabase[num3] || [];
            const colors4 = colorDatabase[num4] || [];
            
            const colorMap = new Map();
            [...colors1, ...colors2, ...colors3, ...colors4].forEach(color => {
                colorMap.set(color.name, color);
            });
            
            const allColors = Array.from(colorMap.values());
            if (allColors.length === 0) {
                allColors.push({ name: '화이트', code: '#FFFFFF' });
            }
            
            text += `당신의 행운의 색상들:
${allColors.map(color => `• ${color.name}`).join('\n')}

설명:
이 색상들은 당신의 사주 기운을 강화시켜주는 행운의 색상입니다. 의상, 소품, 인테리어 등에 활용하면 좋은 기운을 받을 수 있습니다.

활용법:
• 중요한 날 착용할 의상 색상으로 선택
• 집이나 사무실 인테리어에 포인트 컬러로 활용
• 지갑, 핸드폰 케이스 등 소품 색상으로 선택
• 자동차 색상이나 액세서리에 활용

───────────────────────────────────────────────────

📍 추천 지역

`;

            // 추천 지역 생성
            const data1 = chosungDatabase[num1] || { chosung: [], special: [] };
            const data2 = chosungDatabase[num2] || { chosung: [], special: [] };
            const data3 = chosungDatabase[num3] || { chosung: [], special: [] };
            const data4 = chosungDatabase[num4] || { chosung: [], special: [] };
            
            const allChosung = [...new Set([...data1.chosung, ...data2.chosung, ...data3.chosung, ...data4.chosung])];
            const allSpecial = [...new Set([...data1.special, ...data2.special, ...data3.special, ...data4.special])];
            
            text += `당신과 조화를 이루는 초성:
${allChosung.length > 0 ? allChosung.join(', ') : '해당 없음'}

`;

            if (allSpecial.length > 0) {
                text += `특별 키워드:
${allSpecial.join(', ')} 관련 지역이 특히 좋습니다.

`;
            }

            // 카테고리별 지역 정리
            const categorizedRegions = {};
            
            allChosung.forEach(cho => {
                if (regionDatabase[cho]) {
                    Object.entries(regionDatabase[cho]).forEach(([category, regions]) => {
                        if (!categorizedRegions[category]) {
                            categorizedRegions[category] = [];
                        }
                        categorizedRegions[category] = [...categorizedRegions[category], ...regions];
                    });
                }
            });

            text += `추천 지역 목록:

`;

            Object.entries(categorizedRegions).forEach(([category, regions]) => {
                const uniqueRegions = [...new Set(regions)].sort();
                
                text += `【${category}】
`;
                
                // 특별 지역 체크하여 표시
                uniqueRegions.forEach(region => {
                    let isSpecial = false;
                    let specialMark = '';
                    
                    if (allSpecial.includes('물') && waterRegions.some(w => region.includes(w))) {
                        isSpecial = true;
                        specialMark = ' ⭐(물 관련)';
                    } else if (allSpecial.includes('중앙') && centerRegions.some(c => region.includes(c))) {
                        isSpecial = true;
                        specialMark = ' ⭐(중앙 관련)';
                    } else if (allSpecial.includes('북쪽') && northRegions.some(n => region.includes(n))) {
                        isSpecial = true;
                        specialMark = ' ⭐(북쪽 관련)';
                    }
                    
                    text += `• ${region}${specialMark}
`;
                });
                
                text += `
`;
            });

            text += `설명:
위의 초성으로 시작하는 지역들은 당신의 사주 기운과 조화를 이루어 좋은 기운을 가져다 줄 수 있습니다.`;

            if (allSpecial.length > 0) {
                text += ` 특별히 "${allSpecial.join(', ')}"과 관련된 지역(⭐표시)은 더욱 강한 기운을 받을 수 있습니다.`;
            }

            text += `

활용법:
• 이사나 이직 시 지역 선택 참고
• 여행지나 휴양지 선택 시 활용
• 사업장이나 매장 위치 선택 시 고려
• 투자 부동산 지역 선택 시 참고

═══════════════════════════════════════════════════

💡 종합 활용 가이드:

1. 행운의 숫자: 일상의 중요한 선택에서 참고 숫자로 활용
2. 행운의 색상: 의상, 인테리어, 소품 선택 시 우선 고려
3. 추천 지역: 거주, 사업, 여행 등의 장소 선택 시 참고

※ 이 분석은 사주번호를 기반으로 한 참고 자료입니다.
※ 실제 결정은 개인의 상황과 판단을 종합하여 내리시기 바랍니다.

생성일시: ${new Date().toLocaleString('ko-KR')}`;

            return text;
        }

        // 행운 분석 함수
        function analyzeFortune(saju1, saju2, saju3, saju4) {
            // 행운의 숫자 표시
            const luckyNumbersDiv = document.getElementById('fortuneLuckyNumbers');
            luckyNumbersDiv.innerHTML = '';
            
            const specialNumbers = [saju1, saju2, saju3, saju4];
            const allLuckyNumbers = [...new Set([...specialNumbers, ...fortuneLuckyNumbers])].sort((a, b) => a - b);
            
            allLuckyNumbers.forEach(num => {
                const div = document.createElement('div');
                div.className = 'fortune-number-item';
                div.textContent = num;
                luckyNumbersDiv.appendChild(div);
            });
            
            document.getElementById('fortuneNumberDescription').textContent = 
                `사주번호 ${saju1}, ${saju2} / ${saju3}, ${saju4}의 기운과 조화를 이루는 행운의 숫자들입니다. 이 숫자들은 일상생활에서 좋은 기운을 가져다 줄 수 있습니다.`;
            
            // 행운의 색상 표시
            const colorSection = document.getElementById('fortuneColorSection');
            colorSection.innerHTML = '';
            
            const colors1 = colorDatabase[saju1] || [];
            const colors2 = colorDatabase[saju2] || [];
            const colors3 = colorDatabase[saju3] || [];
            const colors4 = colorDatabase[saju4] || [];
            
            // 색상 중복 제거
            const colorMap = new Map();
            [...colors1, ...colors2, ...colors3, ...colors4].forEach(color => {
                colorMap.set(color.name, color);
            });
            
            const allColors = Array.from(colorMap.values());
            
            if (allColors.length === 0) {
                allColors.push({ name: '화이트', code: '#FFFFFF' });
            }
            
            allColors.forEach(color => {
                const div = document.createElement('div');
                div.className = 'fortune-color-item';
                div.textContent = color.name;
                div.style.backgroundColor = color.code;
                
                if (color.name === '화이트') {
                    div.style.color = '#333';
                    div.style.border = '2px solid #ddd';
                } else if (color.name === '블랙') {
                    div.style.border = '2px solid #666';
                }
                
                colorSection.appendChild(div);
            });
            
            document.getElementById('fortuneColorDescription').textContent = 
                `이 색상들은 당신의 사주 기운을 강화시켜주는 행운의 색상입니다. 의상, 소품, 인테리어 등에 활용하면 좋은 기운을 받을 수 있습니다.`;
            
            // 추천 초성 표시
            const chosungSection = document.getElementById('fortuneChosungSection');
            chosungSection.innerHTML = '';
            
            const data1 = chosungDatabase[saju1] || { chosung: [], special: [] };
            const data2 = chosungDatabase[saju2] || { chosung: [], special: [] };
            const data3 = chosungDatabase[saju3] || { chosung: [], special: [] };
            const data4 = chosungDatabase[saju4] || { chosung: [], special: [] };
            
            const allChosung = [...new Set([...data1.chosung, ...data2.chosung, ...data3.chosung, ...data4.chosung])];
            const allSpecial = [...new Set([...data1.special, ...data2.special, ...data3.special, ...data4.special])];
            
            allChosung.forEach(cho => {
                const div = document.createElement('div');
                div.className = 'fortune-chosung-item';
                div.textContent = cho;
                chosungSection.appendChild(div);
            });
            
            // 추천 지역 표시
            const regionContainer = document.getElementById('fortuneRegionContainer');
            regionContainer.innerHTML = '';
            
            // 카테고리별로 지역 정리
            const categorizedRegions = {};
            
            allChosung.forEach(cho => {
                if (regionDatabase[cho]) {
                    Object.entries(regionDatabase[cho]).forEach(([category, regions]) => {
                        if (!categorizedRegions[category]) {
                            categorizedRegions[category] = [];
                        }
                        categorizedRegions[category] = [...categorizedRegions[category], ...regions];
                    });
                }
            });
            
            // 중복 제거 및 카테고리별 표시
            Object.entries(categorizedRegions).forEach(([category, regions]) => {
                const uniqueRegions = [...new Set(regions)].sort();
                
                const categoryDiv = document.createElement('div');
                categoryDiv.className = 'fortune-region-category';
                
                const titleDiv = document.createElement('div');
                titleDiv.className = 'fortune-region-category-title';
                titleDiv.textContent = category;
                categoryDiv.appendChild(titleDiv);
                
                const gridDiv = document.createElement('div');
                gridDiv.className = 'fortune-region-grid';
                
                uniqueRegions.forEach(region => {
                    const regionDiv = document.createElement('div');
                    regionDiv.className = 'fortune-region-item';
                    
                    // 특별 지역 체크
                    let isSpecial = false;
                    if (allSpecial.includes('물') && waterRegions.some(w => region.includes(w))) {
                        isSpecial = true;
                    } else if (allSpecial.includes('중앙') && centerRegions.some(c => region.includes(c))) {
                        isSpecial = true;
                    } else if (allSpecial.includes('북쪽') && northRegions.some(n => region.includes(n))) {
                        isSpecial = true;
                    }
                    
                    if (isSpecial) {
                        regionDiv.classList.add('fortune-special-region');
                        regionDiv.textContent = region + ' ⭐';
                    } else {
                        regionDiv.textContent = region;
                    }
                    
                    gridDiv.appendChild(regionDiv);
                });
                
                categoryDiv.appendChild(gridDiv);
                regionContainer.appendChild(categoryDiv);
            });
            
            let specialText = '';
            if (allSpecial.length > 0) {
                specialText = `\n특별히 "${allSpecial.join(', ')}"과 관련된 지역(⭐표시)은 더욱 강한 기운을 받을 수 있습니다.`;
            }
            
            document.getElementById('fortuneRegionDescription').textContent = 
                `위의 초성으로 시작하는 지역들은 당신의 사주 기운과 조화를 이루어 좋은 기운을 가져다 줄 수 있습니다.${specialText}`;
            
            // 행운 분석 섹션 표시
            document.getElementById('fortuneAnalysisSection').style.display = 'block';
        }

        // 엔터키 이벤트
        document.addEventListener('DOMContentLoaded', function() {
            // 해운번호 입력 이벤트
            document.getElementById('haeun1').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') generateGraph();
            });
            
            document.getElementById('haeun2').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') generateGraph();
            });

            // 사주번호 입력 이벤트
            document.querySelectorAll('.saju-input').forEach(input => {
                input.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') {
                        generateSajuChart();
                    }
                });
            });

            // 사주번호 분석 초기 실행
            generateSajuChart();
        });
    </script>
</body>
</html> 